

#============= audioserver ==============
allow audioserver device:chr_file ioctl;
allow audioserver media_rw_data_file:dir { open read search };
allow audioserver mnt_user_file:dir search;
allow audioserver mnt_user_file:lnk_file read;
allow audioserver sdcardfs:dir { add_name create write };
allow audioserver storage_file:dir search;
allow audioserver storage_file:lnk_file read;
allow audioserver tmpfs:dir search;
allow audioserver unlabeled:file { getattr open read };

#============= bootanim ==============
allow bootanim device:chr_file { getattr ioctl open read write };

#============= fsck ==============
allow fsck block_device:blk_file { ioctl open read write };

#============= init ==============
allow init block_device:blk_file write;
allow init debugfs:file write;
allow init default_android_service:service_manager { add find };
allow init devpts:chr_file setattr;
allow init kmsg_device:chr_file write;
allow init media_rw_data_file:file append;
allow init mediacodec:binder transfer;
allow init mnt_user_file:lnk_file read;
allow init sdcardfs:dir { add_name create open read remove_name search write };
allow init sdcardfs:file { append create getattr open read unlink };
allow init self:netlink_generic_socket { bind create getattr read setopt write };
allow init self:netlink_kobject_uevent_socket { bind create read setopt };
allow init self:netlink_socket { bind create read write };
allow init self:netlink_xfrm_socket { bind create nlmsg_read read write };
allow init self:rawip_socket { create getopt setopt };
allow init self:udp_socket write;
allow init servicemanager:binder { call transfer };
allow init shell_exec:file execute_no_trans;
allow init socket_device:sock_file { create setattr unlink };
allow init storage_file:lnk_file read;
allow init surfaceflinger:binder call;
allow init surfaceflinger_service:service_manager find;
allow init system_data_file:file { append lock };
allow init system_data_file:sock_file write;
allow init system_file:file execute_no_trans;
allow init tmpfs:lnk_file create;

#============= install_recovery ==============
allow install_recovery block_device:blk_file { open read write };

#============= kernel ==============
allow kernel unlabeled:file { open read };

#============= mediacodec ==============
allow mediacodec default_android_service:service_manager find;
allow mediacodec init:binder call;
allow mediacodec init:unix_stream_socket connectto;
allow mediacodec proc:file { ioctl open read };
allow mediacodec proc_meminfo:file { getattr open read };
allow mediacodec property_socket:sock_file write;
allow mediacodec sysfs:file { open read };

#============= netd ==============
allow netd device:chr_file { open write };

#============= platform_app ==============
allow platform_app device:chr_file { getattr ioctl open read write };

#============= priv_app ==============
allow priv_app device:chr_file { getattr ioctl open read write };

#============= servicemanager ==============
allow servicemanager init:binder transfer;
allow servicemanager init:dir search;
allow servicemanager init:file { open read };
allow servicemanager init:process getattr;

#============= surfaceflinger ==============
allow surfaceflinger default_android_service:service_manager add;
allow surfaceflinger device:chr_file { ioctl read write };

#============= system_app ==============
allow system_app device:chr_file { getattr ioctl open read write };

#============= system_server ==============
allow system_server block_device:blk_file { ioctl open read write };
allow system_server debugfs:dir { open read };
allow system_server device:chr_file { getattr ioctl open read write };
allow system_server init:unix_dgram_socket sendto;

#============= toolbox ==============
allow toolbox system_data_file:dir { add_name write };
allow toolbox system_data_file:file { create open write };
allow toolbox unlabeled:dir getattr;
